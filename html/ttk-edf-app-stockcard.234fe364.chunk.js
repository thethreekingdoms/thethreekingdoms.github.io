webpackJsonp([10],{672:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var r,n=l(a(0)),i=l(a(10)),o=l(a(7)),c=l(a(9)),d=l(a(11)),u=l(a(12)),s=a(2),f=(l(s),a(34)),m=l(a(250));function l(e){return e&&e.__esModule?e:{"default":e}}var p=(0,f.wrapper)(m["default"])(r=function(e){function t(){return(0,o["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,i["default"])(t)).apply(this,arguments))}return(0,u["default"])(t,e),(0,c["default"])(t,[{key:"render",value:function(){return this.props.monkeyKing((0,n["default"])({},this.props,{path:"root"}))}}]),t}(s.Component))||r;t["default"]=p,e.exports=t["default"]},673:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=h(a(0)),n=h(a(4)),o=h(a(84)),r=h(a(85)),c=h(a(7)),d=h(a(9));t["default"]=function(e){var t=new s.action(e),a=p["default"].actionCreator((0,i["default"])({},e,{metaAction:t})),r=new g((0,i["default"])({},e,{metaAction:t,extendAction:a})),n=(0,i["default"])({},t,a.gridAction,r);return t.config({metaHandlers:n}),n};var u=h(a(2)),s=a(34),f=h(a(171)),m=h(a(1)),l=a(13),p=h(a(733));function h(e){return e&&e.__esModule?e:{"default":e}}var g=function(){function a(e){var t,i=this;(0,c["default"])(this,a),this.onInit=function(e){var t=e.component,a=e.injections;i.extendAction.gridAction.onInit({component:t,injections:a}),i.component=t,(i.injections=a).reduce("init"),i.load()},this.load=(0,r["default"])(o["default"].mark(function e(){var t;return o["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.webapi.stock.init({id:i.component.props.stockId});case 2:t=e.sent,i.injections.reduce("load",t);case 4:case"end":return e.stop()}},e,i)})),this.prev=(0,r["default"])(o["default"].mark(function e(){var t,a;return o["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.metaAction.gf("data.form.id"),e.next=3,i.webapi.stock.prev(t);case 3:a=e.sent,console.log(a),a?i.injections.reduce("setForm",a):i.metaAction.toast("warn","已经到第一张单据！");case 6:case"end":return e.stop()}},e,i)})),this.next=(0,r["default"])(o["default"].mark(function e(){var t,a;return o["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.metaAction.gf("data.form.id"),e.next=3,i.webapi.stock.next(t);case 3:a=e.sent,console.log(a),a?i.injections.reduce("setForm",a):i.metaAction.toast("warn","已经到最后一张单据！");case 6:case"end":return e.stop()}},e,i)})),this.add=function(){i.injections.reduce("setForm")},this.save=(0,r["default"])(o["default"].mark(function e(){var t,a,r,n;return o["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.metaAction.gf("data.form").toJS(),!(0<(a=i.checkSave(t)).length)){e.next=5;break}return i.metaAction.toast("error",u["default"].createElement("ul",{style:{textAlign:"left"}},a.map(function(e){return u["default"].createElement("li",null,e)}))),e.abrupt("return");case 5:if(!t.id&&0!=t.id){e.next=12;break}return e.next=8,i.webapi.stock.update(t);case 8:(r=e.sent)&&(i.metaAction.toast("success","保存存货成功"),i.injections.reduce("setForm",r)),e.next=16;break;case 12:return e.next=14,i.webapi.stock.create(t);case 14:(n=e.sent)&&(i.metaAction.toast("success","保存存货成功"),i.injections.reduce("setForm",n));case 16:case"end":return e.stop()}},e,i)})),this.tabChange=function(e){i.metaAction.sf("data.other.tabKey",e)},this.categoryChange=function(t){var e=i.metaAction.gf("data.other.categories").find(function(e){return e.get("id")==t});i.metaAction.sf("data.form.category",e)},this.pricingModeChange=function(t){var e=i.metaAction.gf("data.other.pricingModes").find(function(e){return e.get("id")==t});i.metaAction.sf("data.form.pricingMode",e)},this.getTypeDropdownChildren=function(e){if(e)return{_isMeta:!0,value:m["default"].tree.map(e,"children","",function(e){return{name:e.id,component:"TreeSelect.TreeNode",key:e.id,title:e.name,value:e.id,children:e.children}})}},this.typeChange=function(t){var e=i.metaAction.gf("data.other.types").toJS(),a=m["default"].tree.find(e,"children",function(e){return e.id==t});i.metaAction.sf("data.form.type",(0,l.fromJS)(a))},this.typeFocus=(0,r["default"])(o["default"].mark(function e(){return o["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),this.addType=(0,r["default"])(o["default"].mark(function e(){return o["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),this.getImg=function(){return img},this.taxRateChange=function(t){var e=i.metaAction.gf("data.other.taxRates").find(function(e){return e.get("id")==t});i.metaAction.sf("data.form.taxRate",e)},this.meaUnitChange=function(t){var e=i.metaAction.gf("data.other.meaUnits").find(function(e){return e.get("id")==t});i.metaAction.sf("data.form.meaUnit",e)},this.meaUnitFocus=(0,r["default"])(o["default"].mark(function e(){var t;return o["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.webapi.meaUnit.query();case 2:t=e.sent,i.metaAction.sf("data.other.meaUnits",(0,l.fromJS)(t));case 4:case"end":return e.stop()}},e,i)})),this.addMeaUnit=(0,r["default"])(o["default"].mark(function e(){return o["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i.addUnit("data.form.meaUnit");case 1:case"end":return e.stop()}},e,i)})),this.addMeaUnit4UnitGird=function(t){return(0,r["default"])(o["default"].mark(function e(){return o["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i.addUnit("data.form.units."+t+".unit");case 1:case"end":return e.stop()}},e,i)}))},this.addMeaUnit4PriceGird=function(t){return(0,r["default"])(o["default"].mark(function e(){return o["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i.addUnit("data.form.prices."+t+".unit");case 1:case"end":return e.stop()}},e,i)}))},this.addMeaUnit4barcodeGird=function(t){return(0,r["default"])(o["default"].mark(function e(){return o["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i.addUnit("data.form.barcodes."+t+".unit");case 1:case"end":return e.stop()}},e,i)}))},this.addUnit=(t=(0,r["default"])(o["default"].mark(function e(t){var a,r;return o["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.config.apps["mk-app-mea-unit-card"]){e.next=2;break}throw"依赖mk-app-mea-unit-card app,请使用mk clone mk-app-mea-unit-card命令添加";case 2:return e.next=4,i.metaAction.modal("show",{title:"新增",children:i.metaAction.loadApp("mk-app-mea-unit-card",{store:i.component.props.store})});case 4:if(!(a=e.sent)){e.next=10;break}return e.next=8,i.webapi.meaUnit.query();case 8:r=e.sent,i.metaAction.sfs((0,n["default"])({"data.other.meaUnits":(0,l.fromJS)(r)},t,(0,l.fromJS)(a)));case 10:case"end":return e.stop()}},e,i)})),function(e){return t.apply(this,arguments)}),this.imgChange=function(e){i.metaAction.sf("data.other.selectedImgIndex",e)},this.addImg=function(){i.metaAction.toast("error","静态网站未实现")},this.delImg=function(){i.injections.reduce("delImg")},this.addUnitRow=function(e){i.injections.reduce("addUnitRow",e.rowIndex+1)},this.delUnitRow=function(e){i.injections.reduce("delUnitRow",e.rowIndex)},this.addPriceRow=function(e){i.injections.reduce("addPriceRow",e.rowIndex+1)},this.delPriceRow=function(e){i.injections.reduce("delPriceRow",e.rowIndex)},this.addBarcodeRow=function(e){i.injections.reduce("addBarcodeRow",e.rowIndex+1)},this.delBarcodeRow=function(e){i.injections.reduce("delBarcodeRow",e.rowIndex)},this.unitsUnitChange=function(a){return function(t){var e=i.metaAction.gf("data.other.meaUnits").find(function(e){return e.get("id")==t});i.metaAction.sf("data.form.units."+a+".unit",e)}},this.numberFormat=function(e,t,a){return e?t:m["default"].number.format(t,a)},this.metaAction=e.metaAction,this.extendAction=e.extendAction,this.config=f["default"].current,this.webapi=this.config.webapi}return(0,d["default"])(a,[{key:"checkSave",value:function(e){var t=[];return e.code||t.push("存货编码不能为空!"),e.name||t.push("存货名称不能为空!"),t}}]),a}();e.exports=t["default"]},674:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(a(0)),r=d(a(7));t["default"]=function(e){var t=new i.reducer(e),a=c["default"].reducerCreator((0,n["default"])({},e,{metaReducer:t})),r=new f((0,n["default"])({},e,{metaReducer:t}));return(0,n["default"])({},t,a.gridReducer,r)};var u=a(13),i=a(34),o=d(a(171)),s=a(251),c=d(a(733));function d(e){return e&&e.__esModule?e:{"default":e}}var f=function e(t){var d=this;(0,r["default"])(this,e),this.init=function(e,t){var a=(0,s.getInitState)();return d.metaReducer.init(e,a)},this.load=function(e,t){var a=t.stock,r=t.stockCategories,n=t.pricingModes,i=t.stockTypes,o=t.taxRates,c=t.meaUnits;return e=a?d.metaReducer.sf(e,"data.form",(0,u.fromJS)(a)):d.metaReducer.sf(e,"data",(0,u.fromJS)((0,s.getInitState)().data)),e=d.metaReducer.sf(e,"data.other.categories",(0,u.fromJS)(r)),e=d.metaReducer.sf(e,"data.other.pricingModes",(0,u.fromJS)(n)),e=d.metaReducer.sf(e,"data.other.types",(0,u.fromJS)(i)),e=d.metaReducer.sf(e,"data.other.taxRates",(0,u.fromJS)(o)),e=d.metaReducer.sf(e,"data.other.meaUnits",(0,u.fromJS)(c)),d.metaReducer.gf(e,"data.form.barcodes")||(e=d.metaReducer.sf(e,"data.form.barcodes",(0,u.fromJS)([{}]))),e},this.setForm=function(e,t){return e=t?d.metaReducer.sf(e,"data.form",(0,u.fromJS)(t)):d.metaReducer.sf(e,"data.form",(0,u.fromJS)((0,s.getInitState)().data.form)),d.metaReducer.gf(e,"data.form.barcodes")||(e=d.metaReducer.sf(e,"data.form.barcodes",(0,u.fromJS)([{}]))),e},this.delImg=function(e){var t=d.metaReducer.gf(e,"data.form.imgs");if(!t||0==t.size)return e;var a=d.metaReducer.gf(e,"data.other.selectedImgIndex")||0;return e=d.metaReducer.sf(e,"data.form.imgs",t.remove(a)),e=d.metaReducer.sf(e,"data.other.selectedImgIndex",void 0)},this.addRowBefore=function(e,t,a){return e},this.delRowBefore=function(e,t,a){return e},this.metaReducer=t.metaReducer,this.config=o["default"].current};e.exports=t["default"]},733:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n=a(0),i=(r=n)&&r.__esModule?r:{"default":r},o=a(48);t["default"]={actionCreator:function(e){return{gridAction:new o.GridDecorator.action((0,i["default"])({},e,{gridOption:{unitGrid:{path:"data.form.units",selectFieldName:"selected",cellClassName:"mk-app-stock-card-cell",emptyRow:{},getColNames:function(e){return["unit","conversionRate","conversionDesc","isBase","isPu","isSa","isSt"]}},priceGrid:{path:"data.form.prices",selectFieldName:"selected",cellClassName:"mk-app-stock-card-cell",emptyRow:{},getColNames:function(e){return["unit","lastPuPrice","referPuPrice","lastSaPrice","retailPrice","firstTradePrice","secondTradePrice","thirdTradePrice","fourthTradePrice","fifthTradePrice","sixthTradePrice","servenTradePrice","eighthTradePrice","ninthTradePrice","tenthTradePrice"]}},barcodeGrid:{path:"data.form.barcodes",selectFieldName:"selected",cellClassName:"mk-app-stock-card-cell",emptyRow:{},getColNames:function(e){return["barcode","unit"]}}}}))}},reducerCreator:function(e){return{gridReducer:new o.GridDecorator.reducer((0,i["default"])({},e,{gridOption:{unitGrid:{path:"data.form.units",selectFieldName:"selected",cellClassName:"mk-app-stock-card-cell",emptyRow:{},getColNames:function(e){return["unit","conversionRate","conversionDesc","isBase","isPu","isSa","isSt"]}},priceGrid:{path:"data.form.prices",selectFieldName:"selected",cellClassName:"mk-app-stock-card-cell",emptyRow:{},getColNames:function(e){return["unit","lastPuPrice","referPuPrice","lastSaPrice","retailPrice","firstTradePrice","secondTradePrice","thirdTradePrice","fourthTradePrice","fifthTradePrice","sixthTradePrice","servenTradePrice","eighthTradePrice","ninthTradePrice","tenthTradePrice"]}},barcodeGrid:{path:"data.form.barcodes",selectFieldName:"selected",cellClassName:"mk-app-stock-card-cell",emptyRow:{},getColNames:function(e){return["barcode","unit"]}}}}))}}},e.exports=t["default"]}});